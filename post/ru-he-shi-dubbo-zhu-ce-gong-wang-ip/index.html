<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>å¦‚ä½•ä½¿DubboæœåŠ¡æ³¨å†Œå…¬ç½‘IP | Homchen Blog</title>
<link rel="shortcut icon" href="https://homchen.github.io/favicon.ico?v=1694134577381">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://homchen.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="å¦‚ä½•ä½¿DubboæœåŠ¡æ³¨å†Œå…¬ç½‘IP | Homchen Blog - Atom Feed" href="https://homchen.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="å®ç°DubboæœåŠ¡æ³¨å†Œå…¬ç½‘IPï¼Œå¼€å‘å¾®æœåŠ¡é¡¹ç›®ğŸ¤—


å‰è¨€
æœ¬æ–‡é€‚ç”¨äºæœ‰ä¸€å®šåˆ†å¸ƒå¼æ¶æ„åŸºç¡€çš„å°ä¼™ä¼´ä»¬ã€‚
æœ€è¿‘åœ¨å­¦ä¹ å¾®æœåŠ¡æ¶æ„ä¸­ä½¿ç”¨åˆ°äº†dubboå®ç°å¾®æœåŠ¡ä¹‹é—´çš„é€šè®¯ï¼Œspringbootä½œä¸ºå¼€å‘ä¸»ä½“æ¡†æ¶ï¼Œnacosä½œä¸ºæ³¨å†Œä¸­å¿ƒå’Œé…ç½®ä¸­å¿ƒï¼Œ..." />
    <meta name="keywords" content="äº‘æœåŠ¡å™¨,Java,åç«¯" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://homchen.github.io">
  <img class="avatar" src="https://homchen.github.io/images/avatar.png?v=1694134577381" alt="">
  </a>
  <h1 class="site-title">
    Homchen Blog
  </h1>
  <p class="site-description">
    ä¸€ä¸ªæ–°æ‰‹çš„åšå®¢
  </p>
  <div class="menu-container">
    
      
        <a href="https://homchen.github.io" class="menu">
          ğŸ é¦–é¡µ
        </a>
      
    
      
        <a href="https://homchen.github.io/archives" class="menu">
          ğŸ“–å½’æ¡£
        </a>
      
    
      
        <a href="https://homchen.github.io/tags" class="menu">
          ğŸ·æ ‡ç­¾
        </a>
      
    
      
        <a href="https://homchen.github.io/post/about" class="menu">
          âš™å…³äº
        </a>
      
    
      
        <a href="https://homchen.github.io/post/you-lian" class="menu">
          ğŸ§‘â€ğŸ¤â€ğŸ§‘å‹é“¾
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              å¦‚ä½•ä½¿DubboæœåŠ¡æ³¨å†Œå…¬ç½‘IP
            </h2>
            <div class="post-info">
              <span>
                2023-08-29
              </span>
              <span>
                10 min read
              </span>
              
                <a href="https://homchen.github.io/tag/frLBU2uDJ/" class="post-tag">
                  # äº‘æœåŠ¡å™¨
                </a>
              
                <a href="https://homchen.github.io/tag/zXwk_tOa3/" class="post-tag">
                  # Java
                </a>
              
                <a href="https://homchen.github.io/tag/qhkrBCXtj/" class="post-tag">
                  # åç«¯
                </a>
              
            </div>
            
              <img class="post-feature-image" src="https://img0.baidu.com/it/u=2561167437,911060278&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=650&amp;h=366" alt="">
            
            <div class="post-content-wrapper">
              <div class="post-content" v-pre>
                <p>å®ç°DubboæœåŠ¡æ³¨å†Œå…¬ç½‘IPï¼Œå¼€å‘å¾®æœåŠ¡é¡¹ç›®ğŸ¤—</p>
<!-- more -->
<hr>
<h1 id="å‰è¨€"><strong>å‰è¨€</strong></h1>
<p>æœ¬æ–‡é€‚ç”¨äºæœ‰ä¸€å®šåˆ†å¸ƒå¼æ¶æ„åŸºç¡€çš„å°ä¼™ä¼´ä»¬ã€‚</p>
<p>æœ€è¿‘åœ¨å­¦ä¹ å¾®æœåŠ¡æ¶æ„ä¸­ä½¿ç”¨åˆ°äº†<mark>dubbo</mark>å®ç°å¾®æœåŠ¡ä¹‹é—´çš„é€šè®¯ï¼Œ<mark>springboot</mark>ä½œä¸ºå¼€å‘ä¸»ä½“æ¡†æ¶ï¼Œ<mark>nacos</mark>ä½œä¸ºæ³¨å†Œä¸­å¿ƒå’Œé…ç½®ä¸­å¿ƒï¼Œ<mark>springcloud</mark>ç­‰ç›¸å…³ç»„ä»¶ã€‚</p>
<p>äºæ˜¯æˆ‘æ‰“ç®—å†™ä¸€ä¸ªDemoæ¥å·©å›ºå¾®æœåŠ¡æ¶æ„çŸ¥è¯†ï¼Œå…¶ä¸­æ¶‰åŠåˆ°äº†ç”¨æˆ·æœåŠ¡ã€è®¢å•æœåŠ¡ç­‰ã€‚ğŸ˜</p>
<p>åœ¨æœ¬åœ°ç¯å¢ƒä¸­æµ‹è¯•äº†æ‰€ä»¥æ¥å£å‡èƒ½æ­£å¸¸è¿è¡Œï¼Œåˆæ­¥å¯æ–­å®šä»£ç åŸºæœ¬æ²¡æœ‰é—®é¢˜ã€‚äºæ˜¯ï¼Œæˆ‘ä¾¿ä¸Šä¼ è‡³Linuxäº‘æœåŠ¡å™¨ä¸­éƒ¨ç½²è¿è¡Œã€‚ç»è¿‡ä¸€ç³»åˆ—çš„æ“ä½œåï¼Œåœ¨åŒä¸€å°äº‘æœåŠ¡å™¨ä¸­éƒ¨ç½²æˆåŠŸï¼Œè¿è¡Œæ­£å¸¸ã€‚ğŸ˜</p>
<h1 id="å‘ç°é—®é¢˜"><strong>å‘ç°é—®é¢˜</strong></h1>
<p>æœ¬æ¥ä»¥ä¸ºåœ¨ä¸€å°äº‘æœåŠ¡å™¨ä¸­éƒ¨ç½²æˆåŠŸå°±æ˜¯æˆåŠŸï¼Œå¯æ˜¯è½¬å¿µä¸€æƒ³ï¼šğŸ˜æ—¢ç„¶æ˜¯å¾®æœåŠ¡æ¶æ„ï¼Œä¸€èˆ¬éƒ½æ˜¯åˆ†å¼€éƒ¨ç½²ï¼Œè€Œä¸åº”è¯¥æŠŠå…¨éƒ¨çš„æœåŠ¡éƒ½éƒ¨ç½²åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šã€‚</p>
<p>äºæ˜¯æˆ‘ç”¨ä»…æœ‰çš„ä¸¤å°äº‘æœåŠ¡å™¨è¿›è¡Œäº†è¿›ä¸€æ­¥æµ‹è¯•ï¼Œæˆ‘å°†å…¶ä¸­çš„è®¢å•æœåŠ¡éƒ¨ç½²åœ¨äº†å¦å¤–ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œè€Œç”¨æˆ·æœåŠ¡åˆ™ä¿ç•™åœ¨åŸæœ‰æœåŠ¡å™¨ä¸­ï¼Œä¸¤å°æœåŠ¡å™¨ä¹‹é—´å†…ç½‘ä¸ç›¸é€šï¼Œä½†å¯ä»¥é€šè¿‡å…¬ç½‘é€šè®¯ã€‚</p>
<p>è€Œè®¢å•æœåŠ¡æ˜¯ä¾èµ–äºç”¨æˆ·æœåŠ¡çš„æ¥å£çš„ï¼Œåœ¨å¯åŠ¨çš„æ—¶å€™å´å‡ºç°äº†<mark>Dubbo</mark>æ— æ³•æ‰¾åˆ°ç”¨æˆ·æœåŠ¡çš„é—®é¢˜ï¼ŒğŸ˜µæ˜æ˜åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸­éƒ¨ç½²æ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ã€‚</p>
<h1 id="æ’æŸ¥é—®é¢˜"><strong>æ’æŸ¥é—®é¢˜</strong></h1>
<p>çœ‹åˆ°å¯åŠ¨å¤±è´¥ï¼Œæˆ‘é¦–å…ˆæƒ³åˆ°çš„æ˜¯<mark>ç«¯å£</mark>æ˜¯ä¸æ˜¯æ²¡æœ‰å¼€æ”¾ã€‚äºæ˜¯æˆ‘åˆæ£€æŸ¥äº†ä¸€éç«¯å£ï¼Œç¡®è®¤æ‰€æœ‰æ¶‰åŠçš„ç«¯å£ï¼ˆåŒ…æ‹¬dubboçš„é€šè®¯ç«¯å£ï¼‰å‡å·²å¼€æ”¾ï¼Œæ‰€ä»¥ä¸æ˜¯ç«¯å£æœªå¼€æ”¾é—®é¢˜ã€‚</p>
<p>æ¥ç€ï¼Œæˆ‘å»nacosä¸­æŸ¥çœ‹<mark>ç”¨æˆ·</mark>æœåŠ¡æ˜¯å¦æˆåŠŸæ³¨å†Œã€‚æ£€æŸ¥è¿‡åç¡®è®¤ï¼Œç”¨æˆ·æœåŠ¡å·²ç»æ³¨å†Œä¸”ä½¿ç”¨çš„æ˜¯å…¬ç½‘IPã€‚è¯æ˜ç”¨æˆ·æœåŠ¡å¹¶æ²¡æœ‰æŒ‚æ‰ã€‚</p>
<p>å†æ£€æŸ¥ä¸€ä¸‹ç”¨æˆ·æœåŠ¡æä¾›çš„<mark>dubboæ¥å£</mark>æ˜¯å¦æˆåŠŸæ³¨å†Œã€‚å‘ç°dubboç”¨æˆ·æ¥å£è¿˜å­˜æ´»ç€ï¼Œå¯æ˜¯ä¸€çœ‹æ³¨å†Œåœ°å€<strong>127.0.0.1</strong>ï¼å¥½å®¶ä¼™ï¼Œæ€ä¹ˆä¼šæ³¨å†Œæˆå†…ç½‘å›ç¯åœ°å€å‘¢ï¼ŸğŸ˜…éš¾æ€ªåœ¨å¦ä¸€å°æœåŠ¡å™¨ä¸­å¯åŠ¨æ—¶ï¼Œdubboæ‰¾ä¸åˆ°å¯¹åº”çš„æœåŠ¡æä¾›è€…ã€‚</p>
<h1 id="è§£å†³é—®é¢˜"><strong>è§£å†³é—®é¢˜</strong></h1>
<p>ç»è¿‡ä¸€ç•ªèµ„æ–™æŸ¥é˜…å¾—çŸ¥ï¼Œdubboç¡®å®æ˜¯é»˜è®¤æ³¨å†Œå†…ç½‘åœ°å€çš„ï¼Œå¯æ˜¯è¿™æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ<br>
äºæ˜¯ï¼Œæˆ‘å»çœ‹äº†dubboè·å–IPåœ°å€ç›¸å…³çš„æºç ï¼Œé¦–å…ˆè¦æ‰¾åˆ°æœåŠ¡æ³¨å†ŒIPåœ°å€çš„æ–¹æ³•ã€‚</p>
<p>ä»¥ä¸‹æ˜¯åœ¨ServiceConfigç±»ä¸­çš„æ³¨å†Œæ–¹æ³•</p>
<pre><code class="language-java">/**
     * Register &amp; bind IP address for service provider, can be configured separately.
     * Configuration priority: environment variables -&gt; java system properties -&gt; host property in config file -&gt;
     * /etc/hosts -&gt; default network address -&gt; first available network address
     *
     * @param protocolConfig
     * @param map
     * @return
     */
    private static String findConfiguredHosts(ProtocolConfig protocolConfig,
                                              ProviderConfig provider,
                                              Map&lt;String, String&gt; map) {
        boolean anyhost = false;
        // è®¾ç½®ç»‘å®šIPå±æ€§
        String hostToBind = getValueFromConfig(protocolConfig, DUBBO_IP_TO_BIND);
        if (StringUtils.isNotEmpty(hostToBind) &amp;&amp; isInvalidLocalHost(hostToBind)) {
            throw new IllegalArgumentException(&quot;Specified invalid bind ip from property:&quot; + DUBBO_IP_TO_BIND + &quot;, value:&quot; + hostToBind);
        }

        // if bind ip is not found in environment, keep looking up
        if (StringUtils.isEmpty(hostToBind)) {
            hostToBind = protocolConfig.getHost();
            if (provider != null &amp;&amp; StringUtils.isEmpty(hostToBind)) {
                hostToBind = provider.getHost();
            }
            if (isInvalidLocalHost(hostToBind)) {
                anyhost = true;
                if (logger.isDebugEnabled()) {
                    logger.debug(&quot;No valid ip found from environment, try to get local host.&quot;);
                }
                hostToBind = getLocalHost();
            }
        }

        map.put(BIND_IP_KEY, hostToBind);
        // å¦‚æœè®¾ç½®äº†æ³¨å†ŒIPåˆ™ä¼˜å…ˆç”¨æ³¨å†ŒIPä½œä¸ºæ³¨å†Œåœ°å€
        // bind ip is not used for registry ip by default
        String hostToRegistry = getValueFromConfig(protocolConfig, DUBBO_IP_TO_REGISTRY);
        if (StringUtils.isNotEmpty(hostToRegistry) &amp;&amp; isInvalidLocalHost(hostToRegistry)) {
            throw new IllegalArgumentException(&quot;Specified invalid registry ip from property:&quot; + DUBBO_IP_TO_REGISTRY + &quot;, value:&quot; + hostToRegistry);
        } else if (StringUtils.isEmpty(hostToRegistry)) {
            // bind ip is used as registry ip by default
            hostToRegistry = hostToBind;
        }

        map.put(ANYHOST_KEY, String.valueOf(anyhost));

        return hostToRegistry;
    }
</code></pre>
<p>ç”±æ­¤å¯è§ï¼Œdubboæ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­è·å–è¿™ä¸¤ä¸ªç¯å¢ƒå˜é‡çš„ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å»æ‰¾æ‰¾é…ç½®æ–‡ä»¶çš„åŠ è½½æ–¹æ³•ã€‚</p>
<p>ä»¥ä¸‹æ˜¯åœ¨ReferenceConfigç±»ä¸­çš„åŠ è½½é…ç½®çš„æ–¹æ³•</p>
<pre><code class="language-java">/**
     * Append all configuration required for service reference.
     *
     * @return reference parameters
     */
    private Map&lt;String, String&gt; appendConfig() {
        Map&lt;String, String&gt; map = new HashMap&lt;&gt;(16);

        map.put(INTERFACE_KEY, interfaceName);
        map.put(SIDE_KEY, CONSUMER_SIDE);

        ReferenceConfigBase.appendRuntimeParameters(map);

        if (!ProtocolUtils.isGeneric(generic)) {
            String revision = Version.getVersion(interfaceClass, version);
            if (StringUtils.isNotEmpty(revision)) {
                map.put(REVISION_KEY, revision);
            }

            String[] methods = methods(interfaceClass);
            if (methods.length == 0) {
                logger.warn(CONFIG_NO_METHOD_FOUND, &quot;&quot;, &quot;&quot;, &quot;No method found in service interface: &quot; + interfaceClass.getName());
                map.put(METHODS_KEY, ANY_VALUE);
            } else {
                map.put(METHODS_KEY, StringUtils.join(new TreeSet&lt;&gt;(Arrays.asList(methods)), COMMA_SEPARATOR));
            }
        }

        AbstractConfig.appendParameters(map, getApplication());
        AbstractConfig.appendParameters(map, getModule());
        AbstractConfig.appendParameters(map, consumer);
        AbstractConfig.appendParameters(map, this);
        appendMetricsCompatible(map);

        // å…ˆæ‰¾ç³»ç»Ÿå˜é‡DUBBO_IP_TO_REGISTRY
        String hostToRegistry = ConfigUtils.getSystemProperty(DUBBO_IP_TO_REGISTRY);
        if (StringUtils.isEmpty(hostToRegistry)) {
            // æ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ä½¿ç”¨NetUtilså·¥å…·ç±»è·å–æœ¬åœ°IPåœ°å€
            hostToRegistry = NetUtils.getLocalHost();
        } else if (isInvalidLocalHost(hostToRegistry)) {
            throw new IllegalArgumentException(
                    &quot;Specified invalid registry ip from property:&quot; + DUBBO_IP_TO_REGISTRY + &quot;, value:&quot; + hostToRegistry);
        }

        map.put(REGISTER_IP_KEY, hostToRegistry);

        if (CollectionUtils.isNotEmpty(getMethods())) {
            for (MethodConfig methodConfig : getMethods()) {
                AbstractConfig.appendParameters(map, methodConfig, methodConfig.getName());
                String retryKey = methodConfig.getName() + &quot;.retry&quot;;
                if (map.containsKey(retryKey)) {
                    String retryValue = map.remove(retryKey);
                    if (&quot;false&quot;.equals(retryValue)) {
                        map.put(methodConfig.getName() + &quot;.retries&quot;, &quot;0&quot;);
                    }
                }
            }
        }

        return map;
    }
</code></pre>
<p>åœ¨getLocalHostæ–¹æ³•ä¸­ï¼Œdubboä¼šå…ˆå»è·å–å¯¹åº”çš„IPV4åœ°å€ï¼Œæ‰¾ä¸åˆ°æ‰ä¼šå»æ‰¾IPV6åœ°å€ã€‚</p>
<pre><code class="language-java">    public static String getLocalHost() {
        if (HOST_ADDRESS != null) {
            return HOST_ADDRESS;
        }

        InetAddress address = getLocalAddress();
        if (address != null) {
            if (address instanceof Inet6Address) {
                String ipv6AddressString = address.getHostAddress();
                if (ipv6AddressString.contains(&quot;%&quot;)) {
                    ipv6AddressString = ipv6AddressString.substring(0, ipv6AddressString.indexOf(&quot;%&quot;));
                }
                HOST_ADDRESS = ipv6AddressString;
                return HOST_ADDRESS;
            }

            HOST_ADDRESS = address.getHostAddress();
            return HOST_ADDRESS;
        }

        return LOCALHOST_VALUE;
</code></pre>
<pre><code class="language-java">/**
     * Find first valid IP from local network card
     *
     * @return first valid local IP
     */
    public static InetAddress getLocalAddress() {
        if (LOCAL_ADDRESS != null) {
            return LOCAL_ADDRESS;
        }
        InetAddress localAddress = getLocalAddress0();
        LOCAL_ADDRESS = localAddress;
        return localAddress;
    }

</code></pre>
<p>å…¶ä¸­æœ€å…³é”®çš„æ˜¯getLocalAddress0æ–¹æ³•ï¼Œ</p>
<pre><code class="language-java">private static InetAddress getLocalAddress0() {
        InetAddress localAddress = null;

        // @since 2.7.6, choose the {@link NetworkInterface} first
        // å¼€å§‹è½®è¯¢ç½‘å¡
        try {
            NetworkInterface networkInterface = findNetworkInterface();
            Enumeration&lt;InetAddress&gt; addresses = networkInterface.getInetAddresses();
            while (addresses.hasMoreElements()) {
                // è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„é€‚åˆæ³¨å†Œçš„ IP
                Optional&lt;InetAddress&gt; addressOp = toValidAddress(addresses.nextElement());
                if (addressOp.isPresent()) {
                    try {
                        if (addressOp.get().isReachable(100)) {
                            return addressOp.get();
                        }
                    } catch (IOException e) {
                        // ignore
                    }
                }
            }
        } catch (Throwable e) {
            logger.warn(e);
        }
        // æ²¡æœ‰æ‰¾åˆ°é€‚åˆæ³¨å†Œçš„ IPï¼Œå°±ä»è·å– /etc/hosts ä¸­ hostname å¯¹åº”çš„ IP
        try {
            localAddress = InetAddress.getLocalHost();
            Optional&lt;InetAddress&gt; addressOp = toValidAddress(localAddress);
            if (addressOp.isPresent()) {
                return addressOp.get();
            }
        } catch (Throwable e) {
            logger.warn(e);
        }

        localAddress = getLocalAddressV6();

        return localAddress;
    }
</code></pre>
<p>åˆ°æ­¤å·²ç»å¾ˆæ˜æœ—äº†ã€‚å› ä¸ºæˆ‘ä»¬ä¸€å¼€å§‹æ²¡æœ‰é…ç½®å¯¹åº”ç³»ç»Ÿå˜é‡ï¼Œæ‰€ä»¥dubboé»˜è®¤ä¼šæ‰¾åˆ°æˆ‘ä»¬æœ¬åœ°çš„IPåœ°å€ï¼Œè€Œæœ¬åœ°çš„IPåœ°å€é…ç½®é»˜è®¤åˆæ˜¯127.0.0.1çš„å†…ç½‘å›ç¯åœ°å€ï¼Œä»è€Œå¯¼è‡´äº†dubboåœ¨ä¸¤å°å†…ç½‘ä¸åŒçš„æœåŠ¡å™¨ä¸­æ— æ³•æ­£å¸¸é€šè®¯ã€‚</p>
<p>å¯¹æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨äº‘æœåŠ¡å™¨ä¸­ï¼ˆLinuxï¼‰æ‰¾åˆ° /etc/hostsæ–‡ä»¶ï¼Œå°†ç¬¬ä¸€ä¸ªé…ç½®çš„åœ°å€ï¼ˆ127.0.0.1ï¼‰ä¿®æ”¹æˆå¯¹åº”å…¬ç½‘IPåœ°å€å³å¯ã€‚</p>
<p>æˆ–è€…æ–°å»ºä¸€ä¸ªå¯¹åº”çš„IPåœ°å€ï¼Œå¹¶ä¸”åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šé€‰ç”¨ã€‚</p>
<ul>
<li><strong>ä¾‹</strong><br>
åœ¨xmlé…ç½®æ–‡ä»¶ä¸­é…ç½®<pre><code class="language-xml">&lt;dubbo:protocol name=&quot;dubbo&quot; port=&quot;28080&quot; host=&quot;www.example.com&quot; /&gt;
</code></pre>
æˆ–è€…ymlé…ç½®æ–‡ä»¶ä¸­é…ç½®<pre><code class="language-yml">dubbo:
    protocol:
        host: www.example.com
        port: 28080
</code></pre>
ç„¶åæ‰“å¼€ /etc/hosts å¹¶ä»¿ç…§å¯¹åº”æ ¼å¼æ·»åŠ ä¸€è¡Œå†…å®¹ï¼ˆå‡è®¾10.1.1.1ä¸ºå…¬ç½‘IPåœ°å€ï¼‰ï¼š<br>
10.1.1.1 www.example.com www.example.com</li>
</ul>
<p>ç„¶åé‡å¯æœåŠ¡æ£€æŸ¥å…¶æ³¨å†Œçš„IPåœ°å€ï¼Œç¡®è®¤æ˜¯å…¬ç½‘IPï¼Œæ­¤æ—¶å†å¯åŠ¨è®¢å•æœåŠ¡èƒ½æ­£å¸¸è¿è¡Œã€‚</p>
<h1 id="ä¸¾ä¸€åä¸‰"><strong>ä¸¾ä¸€åä¸‰</strong></h1>
<p>æ—¢ç„¶é€šè¿‡ä»¥ä¸Šä¸¤ç§æ–¹å¼è§£å†³äº†dubboæœåŠ¡åœ¨Linuxç³»ç»Ÿä¸Šè¿è¡Œçš„é—®é¢˜ï¼Œé‚£å¦‚æœä»¥åå°†æœåŠ¡éƒ¨ç½²åœ¨dockerå®¹å™¨ä¸­ï¼Œé‚£åˆè¯¥å¦‚ä½•æŒ‡å®šæ³¨å†ŒIPå‘¢ï¼Ÿ</p>
<p>åœ¨ä¸Šè¿°ä»£ç æ³¨é‡Šä¸­å¯çŸ¥ï¼Œåœ¨dubboä¸­é…ç½®æ–‡ä»¶çš„è·å–ä¼˜å…ˆçº§: environment variables -&gt; java system properties -&gt; host property in config file -&gt; /etc/hosts -&gt;<br>
default network address -&gt; first available network address</p>
<p>å› æ­¤æˆ‘ä»¬åªéœ€è¦åœ¨è¿è¡Œdockerå®¹å™¨æ—¶åŠ ä¸Šä¸€ä¸ªDUBBO_IP_TO_REGISTRYç¯å¢ƒå˜é‡å³å¯ã€‚</p>
<ul>
<li>DUBBO_IP_TO_REGISTRY --- æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒçš„IPåœ°å€</li>
<li>DUBBO_PORT_TO_REGISTRY --- æ³¨å†Œä¸­å¿ƒç«¯å£</li>
<li>DUBBO_IP_TO_BIND ---ä¾¦å¬ IP åœ°å€</li>
<li>DUBBO_PORT_TO_BIND ---ä¾¦å¬ç«¯å£</li>
</ul>
<p>å‡è®¾10.1.1.1ä¸ºå…¬ç½‘IPåœ°å€ï¼Œåˆ™ <code>-e DUBBO_IP_TO_REGISTRY=10.1.1.1</code></p>
<h1 id="æ€»ç»“"><strong>æ€»ç»“</strong></h1>
<p>åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œæƒ³è¦ä½¿dubboæœåŠ¡æ³¨å†Œå…¬ç½‘IPçš„æ–¹æ³•æœ‰å‡ ä¸ªï¼Œå¤§å®¶å¯ä»¥é€‰æ‹©é€‚åˆè‡ªå·±çš„æ–¹å¼è¿›è¡Œé…ç½®ã€‚</p>
<p>è€Œåœ¨æˆ‘ä»¬å¹³å¸¸çš„å¼€å‘ä¸­ï¼Œä¼šç»å¸¸é‡åˆ°ä¸€äº›å¥‡å¥‡æ€ªæ€ªæ— æ³•è½»æ˜“è§£å†³çš„é—®é¢˜ã€‚æ­¤æ—¶è®°å¾—ä¸è¦æ…Œä¹±ï¼Œå¯ä»¥å…ˆå»å®˜ç½‘å¯»æ‰¾ç›¸å…³ä¿¡æ¯ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯é…ç½®å‡ºäº†é—®é¢˜ï¼ˆä½¿ç”¨äº†é»˜è®¤é…ç½®ï¼‰ã€‚å…¶æ¬¡è¦äº†è§£é—®é¢˜æ ¹æºåœ¨äºä»€ä¹ˆåœ°æ–¹ï¼Œç„¶åé¡ºç€è¿™ä¸ªæ–¹å‘å»çŒœæƒ³å¯èƒ½å¯¼è‡´çš„åŸå› ï¼Œç„¶åä¸€ä¸€è¿›è¡Œæ’æŸ¥ï¼Œæœ€ç»ˆç¡®è®¤é—®é¢˜æ‰€åœ¨ã€‚è€Œæƒ³è¦è§£å†³ä¸€ä¸ªé—®é¢˜ï¼Œæœ€å¥½æ˜¯å…ˆå¼„æ¸…æ¥šè¿™ä¸ªé—®é¢˜æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Œåªæœ‰ç†è§£äº†è¿™ä¸ªåæ‰èƒ½æ›´å¥½å¸®åŠ©æˆ‘ä»¬è§£å†³é—®é¢˜ï¼Œæå‡è‡ªæˆ‘ã€‚</p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#%E5%89%8D%E8%A8%80"><strong>å‰è¨€</strong></a></li>
<li><a href="#%E5%8F%91%E7%8E%B0%E9%97%AE%E9%A2%98"><strong>å‘ç°é—®é¢˜</strong></a></li>
<li><a href="#%E6%8E%92%E6%9F%A5%E9%97%AE%E9%A2%98"><strong>æ’æŸ¥é—®é¢˜</strong></a></li>
<li><a href="#%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98"><strong>è§£å†³é—®é¢˜</strong></a></li>
<li><a href="#%E4%B8%BE%E4%B8%80%E5%8F%8D%E4%B8%89"><strong>ä¸¾ä¸€åä¸‰</strong></a></li>
<li><a href="#%E6%80%BB%E7%BB%93"><strong>æ€»ç»“</strong></a></li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://homchen.github.io/post/springbootjwt-shi-xian-jian-yi-dan-dian-deng-lu/">
              <h3 class="post-title">
                Springboot+jwtå®ç°ç®€æ˜“å•ç‚¹ç™»å½•ğŸ¤£
              </h3>
            </a>
          </div>
        

        
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: '6e22f01009522181efce',
    clientSecret: 'a020328fc365c8214e3921e783040ff318b25a16',
    repo: 'BlogGitalk',
    owner: 'Homchen',
    admin: ['Homchen'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        

        <div class="site-footer">
  Blog for <a href="https://homchen.github.io" target="_blank">Augus Chen</a>
  <a class="rss" href="https://homchen.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
